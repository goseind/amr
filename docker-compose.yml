version: "3"

services:
  roscore:
    image: ros:noetic-ros-base
    command: roscore
    ports:
      - 11311:11311

  detect:
    build:
      context: ./docker
      dockerfile: Dockerfile
    command: watchmedo auto-restart --patterns="*.py" --kill-after 0.5 --recursive python3 -- /app/main.py
    volumes:
      - ./detect:/app
    devices:
      - /dev/video0:/dev/video0

  nav:
    build:
      context: ./docker
      dockerfile: Dockerfile
    command: watchmedo auto-restart --patterns="*.py" --kill-after 0.5 --recursive python3 -- /app/main.py
    volumes:
      - ./navigation:/app
